<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="Definitions_19luqey" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="4.2.0">
  <bpmn:process id="Process_139nxhl" name="Заява на видалення медичної ліцензії" isExecutable="true">
    <bpmn:startEvent id="Event_0qvn4vn" name="Початок бізнес процесу" camunda:formKey="startForm">
      <bpmn:outgoing>Flow_0032xt2</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:userTask id="Activity_0mgb09n" name="Очікування вводу даних" camunda:formKey="inputTaxPayerId" camunda:assignee="demo" camunda:candidateUsers="demo">
      <bpmn:incoming>Flow_0032xt2</bpmn:incoming>
      <bpmn:outgoing>Flow_1iqzqxu</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="Gateway_10vwvke" name="Медична ліцензія знайдена?">
      <bpmn:incoming>Flow_1o7ahxu</bpmn:incoming>
      <bpmn:outgoing>Flow_08uvyu6</bpmn:outgoing>
      <bpmn:outgoing>Flow_1586f1t</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:userTask id="Activity_0rci05e" name="Медична ліцензія не знайдена" camunda:formKey="showLicenceNotFoundErrorForm">
      <bpmn:incoming>Flow_1586f1t</bpmn:incoming>
      <bpmn:outgoing>Flow_1iny52q</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:endEvent id="Event_1l679ej" name="Завершення бізнес-процесу">
      <bpmn:incoming>Flow_0amo5g3</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_0032xt2" sourceRef="Event_0qvn4vn" targetRef="Activity_0mgb09n" />
    <bpmn:sequenceFlow id="Flow_1iqzqxu" sourceRef="Activity_0mgb09n" targetRef="Activity_1oudbkg" />
    <bpmn:sequenceFlow id="Flow_08uvyu6" name="Так" sourceRef="Gateway_10vwvke" targetRef="Activity_1h877re">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${recordExists}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1586f1t" name="Ні" sourceRef="Gateway_10vwvke" targetRef="Activity_0rci05e">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${!recordExists}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1iny52q" sourceRef="Activity_0rci05e" targetRef="Gateway_05t4fmq" />
    <bpmn:serviceTask id="Activity_1ukpinu" name="Видалення медичної ліцензії">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="method">DELETE</camunda:inputParameter>
            <camunda:inputParameter name="url">http://localhost:8877/mock-server/api/licenses/${id}</camunda:inputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_118i9sl</bpmn:incoming>
      <bpmn:outgoing>Flow_1wh4j16</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:userTask id="Activity_1h877re" name="Підтвердження видалення медичної ліцензії" camunda:formKey="deleteMedicalLicenceForm">
      <bpmn:incoming>Flow_08uvyu6</bpmn:incoming>
      <bpmn:outgoing>Flow_1hm3quy</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_1hm3quy" sourceRef="Activity_1h877re" targetRef="Gateway_0ygg8o3" />
    <bpmn:serviceTask id="Activity_1oudbkg" name="Запит ліцензії за вказаним ІНН">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="method">GET</camunda:inputParameter>
            <camunda:inputParameter name="url">http://localhost:8877/mock-server/api/licenses/search/findByTaxpayerIdentificationNumber?taxpayerIdentificationNumber=${taxpayerIdentificationNumber}</camunda:inputParameter>
            <camunda:outputParameter name="recordExists">${statusCode == 200}</camunda:outputParameter>
            <camunda:outputParameter name="id">${recordExists ? S(response).prop('id').value() : null}</camunda:outputParameter>
            <camunda:outputParameter name="company">${recordExists ? S(response).prop('company').value() : null}</camunda:outputParameter>
            <camunda:outputParameter name="location">${recordExists ? S(response).prop('location').value() : null}</camunda:outputParameter>
            <camunda:outputParameter name="ownerFirstName">${recordExists ? S(response).prop('ownerFirstName').value() : null}</camunda:outputParameter>
            <camunda:outputParameter name="ownerLastName">${recordExists ? S(response).prop('ownerLastName').value() : null}</camunda:outputParameter>
            <camunda:outputParameter name="certificateDate">${recordExists ? S(response).prop('certificateDate').value() : null}</camunda:outputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1iqzqxu</bpmn:incoming>
      <bpmn:outgoing>Flow_1o7ahxu</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_1o7ahxu" sourceRef="Activity_1oudbkg" targetRef="Gateway_10vwvke" />
    <bpmn:exclusiveGateway id="Gateway_0ygg8o3" name="Дія видалення підтвержена?">
      <bpmn:incoming>Flow_1hm3quy</bpmn:incoming>
      <bpmn:outgoing>Flow_118i9sl</bpmn:outgoing>
      <bpmn:outgoing>Flow_09ib54m</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="Flow_118i9sl" name="Так" sourceRef="Gateway_0ygg8o3" targetRef="Activity_1ukpinu">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${!cancel}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1wh4j16" sourceRef="Activity_1ukpinu" targetRef="Activity_0bl8226" />
    <bpmn:exclusiveGateway id="Gateway_05t3x2e">
      <bpmn:incoming>Flow_0uwqs03</bpmn:incoming>
      <bpmn:incoming>Flow_09ib54m</bpmn:incoming>
      <bpmn:outgoing>Flow_1ywqp34</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="Flow_1ywqp34" sourceRef="Gateway_05t3x2e" targetRef="Gateway_05t4fmq" />
    <bpmn:exclusiveGateway id="Gateway_05t4fmq">
      <bpmn:incoming>Flow_1ywqp34</bpmn:incoming>
      <bpmn:incoming>Flow_1iny52q</bpmn:incoming>
      <bpmn:outgoing>Flow_06im9f6</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="Flow_06im9f6" sourceRef="Gateway_05t4fmq" targetRef="Activity_1r4seh9" />
    <bpmn:userTask id="Activity_1r4seh9" name="Заява завершена" camunda:assignee="demo" camunda:candidateUsers="demo">
      <bpmn:incoming>Flow_06im9f6</bpmn:incoming>
      <bpmn:outgoing>Flow_0amo5g3</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_0amo5g3" sourceRef="Activity_1r4seh9" targetRef="Event_1l679ej" />
    <bpmn:userTask id="Activity_0bl8226" name="Медична ліцензія була видалена" camunda:formKey="showSuccessLicenceDeletionForm">
      <bpmn:incoming>Flow_1wh4j16</bpmn:incoming>
      <bpmn:outgoing>Flow_0uwqs03</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_0uwqs03" sourceRef="Activity_0bl8226" targetRef="Gateway_05t3x2e" />
    <bpmn:sequenceFlow id="Flow_09ib54m" name="Ні" sourceRef="Gateway_0ygg8o3" targetRef="Gateway_05t3x2e" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_139nxhl">
      <bpmndi:BPMNEdge id="Flow_09ib54m_di" bpmnElement="Flow_09ib54m">
        <di:waypoint x="840" y="145" />
        <di:waypoint x="840" y="220" />
        <di:waypoint x="1230" y="220" />
        <di:waypoint x="1230" y="145" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1030" y="202" width="11" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0uwqs03_di" bpmnElement="Flow_0uwqs03">
        <di:waypoint x="1160" y="120" />
        <di:waypoint x="1205" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0amo5g3_di" bpmnElement="Flow_0amo5g3">
        <di:waypoint x="1500" y="120" />
        <di:waypoint x="1552" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_06im9f6_di" bpmnElement="Flow_06im9f6">
        <di:waypoint x="1355" y="120" />
        <di:waypoint x="1400" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1ywqp34_di" bpmnElement="Flow_1ywqp34">
        <di:waypoint x="1255" y="120" />
        <di:waypoint x="1305" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1wh4j16_di" bpmnElement="Flow_1wh4j16">
        <di:waypoint x="1010" y="120" />
        <di:waypoint x="1060" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_118i9sl_di" bpmnElement="Flow_118i9sl">
        <di:waypoint x="865" y="120" />
        <di:waypoint x="910" y="120" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="879" y="102" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1o7ahxu_di" bpmnElement="Flow_1o7ahxu">
        <di:waypoint x="510" y="120" />
        <di:waypoint x="565" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1hm3quy_di" bpmnElement="Flow_1hm3quy">
        <di:waypoint x="760" y="120" />
        <di:waypoint x="815" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1iny52q_di" bpmnElement="Flow_1iny52q">
        <di:waypoint x="760" y="280" />
        <di:waypoint x="1330" y="280" />
        <di:waypoint x="1330" y="150" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1586f1t_di" bpmnElement="Flow_1586f1t">
        <di:waypoint x="590" y="145" />
        <di:waypoint x="590" y="280" />
        <di:waypoint x="660" y="280" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="600" y="210" width="11" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_08uvyu6_di" bpmnElement="Flow_08uvyu6">
        <di:waypoint x="615" y="120" />
        <di:waypoint x="660" y="120" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="629" y="102" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1iqzqxu_di" bpmnElement="Flow_1iqzqxu">
        <di:waypoint x="360" y="120" />
        <di:waypoint x="410" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0032xt2_di" bpmnElement="Flow_0032xt2">
        <di:waypoint x="208" y="120" />
        <di:waypoint x="260" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Event_0qvn4vn_di" bpmnElement="Event_0qvn4vn">
        <dc:Bounds x="172" y="102" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="153" y="145" width="77" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0mgb09n_di" bpmnElement="Activity_0mgb09n">
        <dc:Bounds x="260" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_10vwvke_di" bpmnElement="Gateway_10vwvke" isMarkerVisible="true">
        <dc:Bounds x="565" y="95" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="562" y="40" width="55" height="40" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0rci05e_di" bpmnElement="Activity_0rci05e">
        <dc:Bounds x="660" y="240" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1l679ej_di" bpmnElement="Event_1l679ej">
        <dc:Bounds x="1552" y="102" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1533" y="145" width="77" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1ukpinu_di" bpmnElement="Activity_1ukpinu">
        <dc:Bounds x="910" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1h877re_di" bpmnElement="Activity_1h877re">
        <dc:Bounds x="660" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1oudbkg_di" bpmnElement="Activity_1oudbkg">
        <dc:Bounds x="410" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0ygg8o3_di" bpmnElement="Gateway_0ygg8o3" isMarkerVisible="true">
        <dc:Bounds x="815" y="95" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="803" y="65" width="74" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_05t3x2e_di" bpmnElement="Gateway_05t3x2e" isMarkerVisible="true">
        <dc:Bounds x="1205" y="95" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_05t4fmq_di" bpmnElement="Gateway_05t4fmq" isMarkerVisible="true">
        <dc:Bounds x="1305" y="95" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1r4seh9_di" bpmnElement="Activity_1r4seh9">
        <dc:Bounds x="1400" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0bl8226_di" bpmnElement="Activity_0bl8226">
        <dc:Bounds x="1060" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
